# 新規チャット引き継ぎチェックリスト（永続）

このファイルは、チャットを新規開始したときに漏れやすい決定事項を集約したものです。  
`docs/wire.md` と `docs/codex_shared_context.md` と合わせて参照します。

## 1. プロダクト方針（固定）
- 目的は「手作業で厳密に作る」ではなく「自動生成でそれっぽく大量生成」。
- 見た目の自然さを最優先。自動生成主役、手修正は補助導線。
- Core はネイティブ C++、viewer は検証環境。ゲームエンジン非依存を維持。

## 2. データモデル境界（固定）
- `slot` はテンプレート候補点、`Port` は実接続点。混同しない。
- `Span` は実区間として残す。複数本の論理単位は `WireGroup` / `WireLane`。
- `Bundle` は見た目寄り補助。論理正本にしない。
- 接続点近傍の見た目（碍子等）は Port 側責務。Span 端スタイルを正本にしない。

## 3. DrawPath/生成の扱い（固定）
- DrawPath は「入力ガイド」。ネットワーク正本ではない。
- 生成は全削除・全再生成禁止。局所更新を優先。
- 手修正された要素（最低 Port 位置）は軽微再生成で上書きしない。
- Path categories は複数選択できる UI 前提。

## 4. 鋭角対策（固定）
- 固定ルールで運用する: 目的は線間距離確保、`corner interior angle < 75°`、カテゴリ例外なし、UI調整なし、不足時は自動拡幅。

## 5. Viewer UX 方針（固定）
- 操作感は Blender 寄り（カメラ/操作導線）。
- UI は作業領域優先。パネル肥大・乱立を避ける。
- ワークスペース幅は調整可能であること。
- ウィンドウサイズ/主要 UI 状態は再起動後も維持すること。
- `Esc` は作業キャンセル用途を優先し、アプリ即終了にしない。

## 6. テスト運用（固定）
- テストは先にケース表を作る（目的/前提/入力/期待/観測点/守る価値）。
- `Exact` は決定論のみ、その他は不変条件で検証。
- 公開 API と観測可能事実で検証する（実装依存禁止）。
- 異常系を必ず入れる（診断情報、握り潰しなし、復帰可能性）。
- モックは外部境界のみ。ドメインロジックのモック禁止。
- 時間/並行は決定論化（実時間待ちを避ける）。
- テスト追加時は自己レビュー（実装依存/観測可能性/モック過多/異常系/フレーク）。

## 7. タスク進め方（固定）
- 要件が曖昧なら、実装前に質問して合格基準を確定する。
- 「症状」ではなく「ユーザ価値」をテストに落としてから修正する。
- 大きい変更の前は、現状をコミットして退避点を作る。
- 仕様・運用ルールがチャットで確定したら、同ターンで docs に反映する。

## 8. 実装後の確認（固定）
- `wire_core_tests` 全件パスを確認。
- viewer の手動確認項目（操作・生成・可視化・再起動保持）を確認。
- docs 更新漏れがないことを確認。
